<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Christmas Tree 2026</title>
    <!-- 1. 救命样式：强制铺满屏幕 -->
    <style>
      html, body, #root {
        width: 100%; height: 100%; margin: 0; padding: 0;
        overflow: hidden; background-color: #000;
      }
      canvas { display: block; width: 100%; height: 100%; }
    </style>
    <script type="module" crossorigin src="./assets/index-CVRyuv3a.js"></script>
    <link rel="modulepreload" crossorigin href="./assets/react-vendor-Bzgz95E1.js">
    <link rel="modulepreload" crossorigin href="./assets/three-vendor-IWongE37.js">
    <link rel="modulepreload" crossorigin href="./assets/postprocessing-vendor-Oz0s9CZI.js">
  </head>
  <body>
    <!-- 2. 关键：圣诞树的家 (绝对不能少) -->
    <div id="root"></div>
    
    <!-- 3. 启动程序的脚本 -->

    <!-- ==================== 下面是贺卡生成器 ==================== -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <!-- 底部落款 -->
    <div id="copyright-box" style="position: fixed; bottom: 25px; left: 0; width: 100%; text-align: center; z-index: 9998; pointer-events: none; color: rgba(255, 255, 255, 0.85); text-shadow: 0 2px 10px rgba(0,0,0,1);">
      <div style="font-family: 'Songti SC', serif; font-size: 14px; letter-spacing: 3px; opacity: 0.9;">红豆生南国 · 敬制</div>
    </div>

    <!-- 生成按钮 -->
    <div onclick="createArtPoster()" style="position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%); background: rgba(255, 255, 255, 0.15); border: 1px solid rgba(255, 255, 255, 0.4); color: #fff; padding: 8px 30px; border-radius: 50px; font-size: 14px; letter-spacing: 2px; cursor: pointer; z-index: 9999; backdrop-filter: blur(10px); pointer-events: auto; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3); font-weight: bold;">
      生成贺卡
    </div>

    <!-- 海报弹窗 -->
    <div id="poster-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.96); z-index: 10000; flex-direction: column; align-items: center; justify-content: center;">
      <div style="color: #ccc; margin-bottom: 15px; font-size: 13px;">长按图片保存 · 分享给朋友</div>
      <img id="final-image" style="width: 82%; max-width: 450px; border: 1px solid #333; box-shadow: 0 20px 60px rgba(0,0,0,0.6);" />
      <div onclick="document.getElementById('poster-modal').style.display='none'" style="margin-top: 25px; color: #fff; font-size: 30px; cursor: pointer; opacity: 0.7; width: 50px; height: 50px; line-height: 45px; text-align: center; border: 1px solid #555; border-radius: 50%;">×</div>
    </div>

    <div id="qrcode-container" style="display: none;"></div>

    <script>
      function createArtPoster() {
        const treeCanvas = document.querySelector('canvas');
        if (!treeCanvas) { alert('请稍等，画面加载中...'); return; }
        const cvs = document.createElement('canvas');
        const ctx = cvs.getContext('2d');
        const W = 1080; const H = 1920;
        cvs.width = W; cvs.height = H;

        // 背景
        const bg = ctx.createLinearGradient(0, 0, 0, H);
        bg.addColorStop(0, '#020408'); bg.addColorStop(1, '#111827');
        ctx.fillStyle = bg; ctx.fillRect(0, 0, W, H);

        // 圣诞树
        const sSize = Math.min(treeCanvas.width, treeCanvas.height);
        const sx = (treeCanvas.width - sSize) / 2;
        const sy = (treeCanvas.height - sSize) / 2;
        ctx.drawImage(treeCanvas, sx, sy, sSize, sSize, -50, 100, W+100, W+100);

        // 文字
        ctx.textAlign = 'center';
        ctx.font = 'bold 200px "Times New Roman"'; ctx.fillStyle = 'rgba(255, 255, 255, 0.03)';
        ctx.fillText('2026', W/2, 300);

        const textY = 1350;
        ctx.font = '50px "Songti SC", "SimSun", serif'; ctx.fillStyle = '#fceabb';
        ctx.fillText('岁岁常欢愉 · 年年皆胜意', W/2, textY);
        ctx.font = 'italic 30px "Times New Roman"'; ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';
        ctx.fillText('Merry Christmas & Happy New Year', W/2, textY + 60);

        // 二维码
        const footerY = H - 260;
        document.getElementById('qrcode-container').innerHTML = '';
        new QRCode(document.getElementById('qrcode-container'), {
          text: window.location.href, width: 200, height: 200, colorDark : "#000000", colorLight : "#ffffff", correctLevel : QRCode.CorrectLevel.H
        });
        setTimeout(() => {
          const qrImg = document.getElementById('qrcode-container').querySelector('img');
          if (qrImg) {
            ctx.fillStyle = 'white'; ctx.fillRect((W - 180)/2, footerY, 180, 180);
            ctx.drawImage(qrImg, (W - 160)/2, footerY + 10, 160, 160);
            ctx.font = '32px "Microsoft YaHei"'; ctx.fillStyle = '#ffffff';
            ctx.fillText('公众号：获嘉诗词空间', W/2, footerY - 50);
          }
          document.getElementById('final-image').src = cvs.toDataURL('image/jpeg', 0.9);
          document.getElementById('poster-modal').style.display = 'flex';
        }, 100);
      }
    </script>
  </body>
</html>
